# Debug Legality Test Mode

This debug mode visualizes the winning paths that the legality checker finds for each player, helping diagnose issues with blocking detection.

## How to Enable

In the browser console, set the debug flag:

```javascript
window.DEBUG_LEGALITY_TEST = true
```

Then the UI will show an overlay with the winning paths.

## What You'll See

### Visual Indicators

- **Light lines with small dots** (15% opacity): All edges visited during the BFS search - shows lines from hex centers to edge midpoints
- **Thick dashed colored lines** (70% opacity): The actual winning path through specific hex edges
- **Large colored dots** (80% opacity): Specific hex edges (position + direction) on the winning path
- **Legend (top-right corner)**: Shows each player with their path status and edge count

### Legend Information

For each player:
- **Color indicator**: Circle showing the player's color
- **Status**: 
  - Green "PATH FOUND" if a winning path exists
  - Red "NO PATH" if the player is blocked
- **Path length**: Number of edges in the winning path (if found)

## How to Use

1. Enable debug mode in the console
2. Play the game normally
3. When you place or preview a tile, you'll see the winning paths
4. If a player shows "NO PATH" when you expect a path, this indicates a bug in the blocking detection
5. If a player shows "PATH FOUND" when they should be blocked, this also indicates a bug

## Understanding the Path

The path shows:
- **Specific hex edges** (not just hex positions) that can be traversed to create a winning flow
- Each edge is visualized as a line from the hex center to the edge midpoint
- Whether empty hexes are being considered correctly (all edges connected)
- Whether tile flow patterns are being respected (only specific edges connected)

For occupied tiles, the path should only go through the specific edges that the tile's flow pattern connects.
For empty tiles, the path can go through any edges since any tile could potentially be placed there.

## Disabling

To turn off debug mode:

```javascript
window.DEBUG_LEGALITY_TEST = false
```

Or simply refresh the page.

## Technical Details

The visualization is generated by the edge-based flow graph algorithm:
- Creates nodes for each edge of each hex (position + direction)
- Occupied tiles: only edges connected by the tile's flow pattern are linked
- Empty tiles: all edges are connected (any tile could be placed)
- BFS searches from player's start edges to target edges
- Returns both the path and all visited positions for visualization
